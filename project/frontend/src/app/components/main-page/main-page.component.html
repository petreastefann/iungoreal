<app-navbar></app-navbar>

<div id="body">
	<div id="left-section">
		<p>left menu content. left menu content. left menu content. left menu content.
			left menu content. left menu content. left menu content. left menu content.
			left menu content. left menu content. left menu content.
		</p>
	</div>
	<div id="middle-section" (scroll)="onScroll()">
		<div id="post-sort">Sort by:
			<button>New</button>
			<button>Hot</button>
			<button>Top</button>
		</div>

		<ng-container *ngFor="let post of posts; let i = index">
			<div class="post-preview">
				<div class="post-header">
					<h3>{{ post.title }}</h3>
					<p>{{ post.description }}</p>
					<i>author: {{ post.authorUsername }}</i>
				</div>

				<div class="post-image">
					<button (click)="previousImage(i)" [disabled]="currentPostIndexes[i] === 0">&larr;</button>
					<ng-container *ngIf="isImage(post.mediaLinks[currentPostIndexes[i]]); else videoTemplate">
						<img [src]="post.mediaLinks[currentPostIndexes[i]]" alt="Post Image">
					</ng-container>
					<ng-template #videoTemplate>
						<video controls>
							<source [src]="post.mediaLinks[currentPostIndexes[i]]" type="video/mp4">
							Your browser does not support the video tag.
						</video>
					</ng-template>
					<button (click)="nextImage(i)"
						[disabled]="currentPostIndexes[i] === post.mediaLinks.length - 1">&rarr;</button>
				</div>

				<p>({{ currentPostIndexes[i] + 1 }})</p>
				

				<div class="post-buttons">
					<button>Like</button>
					<button>Dislike</button>
					<button>Comment</button>
					<button>Save</button>
				</div>
			</div>

		</ng-container>

		<button (click)="fetchPosts()">load more</button>
	</div>
	<div id="right-section">
		<h4>friends</h4>

		<ng-container *ngIf="friendsUsernames.length > 0; else noFriends">
			<button *ngFor="let friendUsername of friendsUsernames" type="button"
				[routerLink]="['/user', friendUsername]">
				{{ friendUsername }}
			</button>
		</ng-container>

		<ng-template #noFriends>
			<p>this place is kind of empty..</p>
		</ng-template>
	</div>
</div>